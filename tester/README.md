# 🚀 LIBASM 最高のテスタースイート v2.0

libasm プロジェクト用の包括的で高性能なテスターシステムです。色付き出力、統計、ベンチマーク、メモリリークテストを含む完全なテストフレームワークを提供します。

## ✨ 特徴

- 🎨 **美しい色付き出力** - 視認性の高いテスト結果表示
- 📊 **詳細な統計情報** - 成功率、実行時間、パフォーマンス統計
- ⚡ **高性能ベンチマーク** - 関数のパフォーマンス測定
- 🔍 **メモリリーク検出** - ft_strdup等のメモリ管理テスト
- 🧪 **包括的テストケース** - エッジケース、境界値テスト
- 🎯 **個別関数テスト** - 特定の関数のみを対象にしたテスト
- 🚀 **ストレステスト** - 高負荷での安定性テスト
- 🔧 **柔軟な設定** - コマンドライン引数による詳細制御

## 📦 構成ファイル

```
tester/
├── Makefile          # 統合ビルドシステム
├── README.md         # このファイル
├── test_utils.h      # 共通テストユーティリティ（ヘッダー）
├── test_utils.c      # 共通テストユーティリティ（実装）
├── main_tester.c     # メインテストランナー
├── test_strlen.c     # ft_strlen テスト
├── test_strcmp.c     # ft_strcmp テスト
├── test_strcpy.c     # ft_strcpy テスト
├── test_strdup.c     # ft_strdup テスト
├── test_write.c      # ft_write テスト
└── test_read.c       # ft_read テスト
```

## 🔧 ビルド方法

### 前提条件

- macOS または Linux
- GCC または Clang コンパイラ
- NASM アセンブラ
- Make
- valgrind (Linux のみ、メモリテスト用)

### クイックスタート

```bash
# testerディレクトリに移動
cd tester

# 全てをビルド
make all

# 基本テストを実行
make test

# ヘルプを表示
make help
```

## 🎮 使用方法

### 基本的な使用法

```bash
# 基本テストスイートを実行
./main_tester

# ヘルプを表示
./main_tester --help
```

### テストモード

#### 1. 基本テスト（デフォルト）
```bash
./main_tester --basic
# または
./main_tester
```

#### 2. 包括的テスト
```bash
./main_tester --comprehensive
```

#### 3. ベンチマークテスト
```bash
# デフォルト（100,000回実行）
./main_tester --benchmark

# 高精度ベンチマーク（1,000,000回実行）
./main_tester --benchmark --iterations 1000000
```

#### 4. メモリテスト
```bash
./main_tester --memory
```

#### 5. ストレステスト
```bash
# デフォルト（10秒間）
./main_tester --stress

# 長時間ストレステスト（60秒間）
./main_tester --stress --duration 60
```

### 特定関数のテスト

```bash
# ft_strlen のみをテスト
./main_tester --function strlen

# ft_strdup のベンチマークテスト
./main_tester --benchmark --function strdup

# ft_write の詳細テスト
./main_tester --function write --verbose
```

### 出力制御

```bash
# 詳細出力
./main_tester --verbose

# 最小限の出力
./main_tester --quiet
```

## 🎯 Make ターゲット

### 基本操作

```bash
make help           # ヘルプ表示
make all            # 全てビルド
make clean          # 生成ファイル削除
make fclean         # 完全クリーンアップ
make re             # リビルド
```

### テスト実行

```bash
make test           # 統合テストスイート実行
make test_all       # 全種類のテストを実行
make memory_test    # メモリリークテスト
make benchmark      # パフォーマンステスト
```

### 個別関数テスト

```bash
make test_strlen    # ft_strlen テスト
make test_strcmp    # ft_strcmp テスト
make test_strcpy    # ft_strcpy テスト
make test_strdup    # ft_strdup テスト
make test_write     # ft_write テスト
make test_read      # ft_read テスト
```

## 🔍 テスト項目

### ft_strlen テスト
- ✅ 空文字列
- ✅ 通常の文字列
- ✅ 長い文字列（10,000文字）
- ✅ 1文字の文字列
- ✅ 特殊文字を含む文字列

### ft_strcmp テスト
- ✅ 同じ文字列の比較
- ✅ 異なる文字列の比較
- ✅ 空文字列との比較
- ✅ 長さが異なる文字列
- ✅ 大文字小文字の比較
- ✅ 特殊文字を含む文字列

### ft_strcpy テスト
- ✅ 通常の文字列コピー
- ✅ 空文字列のコピー
- ✅ 長い文字列のコピー
- ✅ 戻り値の確認
- ✅ 特殊文字を含む文字列

### ft_strdup テスト
- ✅ 通常の文字列の複製
- ✅ 空文字列の複製
- ✅ 長い文字列の複製
- ✅ メモリアドレスの違い確認
- ✅ メモリリーク検出

### ft_write テスト
- ✅ 標準出力への書き込み
- ✅ ファイルへの書き込み
- ✅ 空データの書き込み
- ✅ 無効なファイルディスクリプタ
- ✅ 大きなデータの書き込み
- ✅ errno 設定の確認

### ft_read テスト
- ✅ 通常ファイルの読み取り
- ✅ 部分読み取り
- ✅ ゼロバイト読み取り
- ✅ 無効なファイルディスクリプタ
- ✅ NULLバッファ
- ✅ errno 設定の確認

## 📊 出力例

### 基本テスト出力
```
============================================================
            LIBASM 統合テストスイート v2.0
============================================================
実行モード: 基本テスト

============================================================
                テストスイート: ft_strlen
============================================================
  テストケース: 基本テスト
    ✓ PASS (0.15ms)
ℹ テストスイート完了

============================================================
              テスト実行結果サマリー
============================================================
  総テスト数:   6
  成功:        6
  失敗:        0
  スキップ:    0
  実行時間:    2.34ms
  成功率:      100% 🎉

✓ 全テストが正常に完了しました！ 🎉
```

### ベンチマーク出力
```
============================================================
              パフォーマンステスト実行中
============================================================
イテレーション数: 100000

  パフォーマンステスト: ft_strlen
パフォーマンステスト: [████████████████████████████████████████] 100% (100000/100000)
  📊 ベンチマーク結果: ft_strlen
    総実行時間: 45.123ms
    イテレーション数: 100000
    平均実行時間: 0.000451ms/回
    スループット: 2217294 ops/sec
```

## 🛠️ カスタマイズ

### 新しいテストケースの追加

1. `test_utils.h` に新しいテスト関数を宣言
2. `main_tester.c` に実装を追加
3. 必要に応じて新しいテストファイルを作成
4. `Makefile` を更新

### テスト設定の変更

`main_tester.c` の設定構造体を編集して、デフォルト値を変更できます：

```c
test_config_t config = {
    .benchmark_iterations = 500000,  // ベンチマーク回数を変更
    .stress_test_duration = 30,      // ストレステスト時間を変更
    // ...
};
```

## 🐛 トラブルシューティング

### よくある問題

#### 1. ビルドエラー
```bash
# libasm.a が見つからない場合
cd .. && make all
cd tester && make all
```

#### 2. テスト失敗
```bash
# 詳細情報を表示
./main_tester --verbose

# 特定の関数のみテスト
./main_tester --function strlen
```

#### 3. メモリリークエラー（Linux）
```bash
# valgrind でデバッグ
valgrind --leak-check=full ./main_tester --memory
```

#### 4. macOS でのメモリテスト
```bash
# leaks コマンドを使用
leaks --atExit -- ./main_tester --memory
```

## 📈 パフォーマンス最適化のヒント

1. **ベンチマークイテレーション調整**: `--iterations` で測定精度を向上
2. **特定関数フォーカス**: `--function` で対象を絞って詳細分析
3. **静かな実行**: `--quiet` でオーバーヘッドを削減
4. **ストレステスト**: `--stress` で安定性確認

## 🤝 コントリビューション

新しいテストケースやベンチマークの追加は大歓迎です！

1. 新機能の実装
2. テストカバレッジの向上
3. パフォーマンス改善
4. ドキュメントの充実

## 📄 ライセンス

このテスターは libasm プロジェクトの一部として提供されています。

---

**🎉 最高のテスターで、最高のlibasmを作り上げましょう！** 